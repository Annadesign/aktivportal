<style type="text/css">
 #map {
  height:100%;
  iframe {
    height:100%;
    width:100%;
    border:0;
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); /* Firefox 10+ */
    filter: gray; /* IE6-9 */
    -webkit-filter: grayscale(99%); /* Chrome 19+ & Safari 6+ */
    -webkit-backface-visibility: hidden;  /* Fix for transition flickering */
  }
} 
</style>

<section class="section-padding">
 <div class="container">
    <div class="row">
       <div class="col-lg-5 col-md-5">
            <%= image_tag @event.image.url(:large), :class => "rounded img-fluid" if @event.image? %>
        </div>
        <div class="col-lg-7 col-md-7 pl-5 pr-5">
            <h1 class="mb-0 mt-3"><%= @event.title %></h1>
            <h5 class="text-success mt-3 mb-3"><%= @event.summary %></h5>
            <p><%= @event.content.html_safe %></p>
            <div class="row mt-3">
               <div class="col-lg-12 col-md-12">
                <% @event.tags.each do |tag| %>
                    <%= link_to tag.name, events_path(tag: tag.name), :class => 'badge badge-info' %>
                <% end %>
               </div>
              
            </div>
            <div class="footer-social mt-5"><span></span>
                <div id="map" style="width:100%;height:300px"></div>
            </div>
        </div>
      </div>
    </div>
</section>
<script type="text/javascript">
    document.getElementById("bgimg").style.backgroundImage = "url(<%= @event.image.url(:large) %>)";
</script>
<script type="text/javascript">

      function initMap() {
        var aktivstart = {lat: <%= @event.lat %>, lng: <%= @event.lng %>};

        var map = new google.maps.Map(document.getElementById('map'), {
          center: aktivstart,
          zoom: 11,
          streetViewControl: false,

          styles: [
              {
                  "featureType": "administrative",
                  "elementType": "labels.text.fill",
                  "stylers": [
                      {
                          "color": "#444444"
                      }
                  ]
              },
              {
                  "featureType": "administrative.locality",
                  "elementType": "labels",
                  "stylers": [
                      {
                          "visibility": "on"
                      }
                  ]
              },
              {
                  "featureType": "landscape",
                  "elementType": "all",
                  "stylers": [
                      {
                          "color": "#f2f2f2"
                      },
                      {
                          "visibility": "simplified"
                      }
                  ]
              },
              {
                  "featureType": "poi",
                  "elementType": "all",
                  "stylers": [
                      {
                          "visibility": "on"
                      }
                  ]
              },
              {
                  "featureType": "poi",
                  "elementType": "geometry",
                  "stylers": [
                      {
                          "visibility": "simplified"
                      },
                      {
                          "saturation": "-65"
                      },
                      {
                          "lightness": "45"
                      },
                      {
                          "gamma": "1.78"
                      }
                  ]
              },
              {
                  "featureType": "poi",
                  "elementType": "labels",
                  "stylers": [
                      {
                          "visibility": "off"
                      }
                  ]
              },
              {
                  "featureType": "poi",
                  "elementType": "labels.icon",
                  "stylers": [
                      {
                          "visibility": "off"
                      }
                  ]
              },
              {
                  "featureType": "road",
                  "elementType": "all",
                  "stylers": [
                      {
                          "saturation": -100
                      },
                      {
                          "lightness": 45
                      }
                  ]
              },
              {
                  "featureType": "road",
                  "elementType": "labels",
                  "stylers": [
                      {
                          "visibility": "on"
                      }
                  ]
              },
              {
                  "featureType": "road",
                  "elementType": "labels.icon",
                  "stylers": [
                      {
                          "visibility": "off"
                      }
                  ]
              },
              {
                  "featureType": "road.highway",
                  "elementType": "all",
                  "stylers": [
                      {
                          "visibility": "simplified"
                      }
                  ]
              },
              {
                  "featureType": "road.highway",
                  "elementType": "labels.icon",
                  "stylers": [
                      {
                          "visibility": "off"
                      }
                  ]
              },
              {
                  "featureType": "road.arterial",
                  "elementType": "labels.icon",
                  "stylers": [
                      {
                          "visibility": "off"
                      }
                  ]
              },
              {
                  "featureType": "transit.line",
                  "elementType": "geometry",
                  "stylers": [
                      {
                          "saturation": "-33"
                      },
                      {
                          "lightness": "22"
                      },
                      {
                          "gamma": "2.08"
                      }
                  ]
              },
              {
                  "featureType": "transit.station.airport",
                  "elementType": "geometry",
                  "stylers": [
                      {
                          "gamma": "2.08"
                      },
                      {
                          "hue": "#ffa200"
                      }
                  ]
              },
              {
                  "featureType": "transit.station.airport",
                  "elementType": "labels",
                  "stylers": [
                      {
                          "visibility": "off"
                      }
                  ]
              },
              {
                  "featureType": "transit.station.rail",
                  "elementType": "labels.text",
                  "stylers": [
                      {
                          "visibility": "off"
                      }
                  ]
              },
              {
                  "featureType": "transit.station.rail",
                  "elementType": "labels.icon",
                  "stylers": [
                      {
                          "visibility": "simplified"
                      },
                      {
                          "saturation": "-55"
                      },
                      {
                          "lightness": "-2"
                      },
                      {
                          "gamma": "1.88"
                      },
                      {
                          "hue": "#ffab00"
                      }
                  ]
              },
              {
                  "featureType": "water",
                  "elementType": "all",
                  "stylers": [
                      {
                          "color": "#bbd9e5"
                      },
                      {
                          "visibility": "simplified"
                      }
                  ]
              }
          ]

        });

    


        // Create a marker and set its position.
          var marker<%= @event.id %> = new google.maps.Marker({
            map: map,
            position: {lat:<%= @event.lat %>, lng:<%= @event.lng %>},
            title: '<%= @event.title %>',
            icon: {
              url: "https://maps.google.com/mapfiles/ms/icons/blue-dot.png",
              labelOrigin: new google.maps.Point(20, 38),
              size: new google.maps.Size(32,32),
              anchor: new google.maps.Point(16,32)
            },
            label: {
              text: "<%= @event.title %>"
            },
            draggable: true,
            animation: google.maps.Animation.DROP

          });
          marker<%= @event.id %>.addListener('click', toggleBounce);

          function toggleBounce() {
            if (marker<%= @event.id %>.getAnimation() !== null) {
              marker<%= @event.id %>.setAnimation(null);
            } else {
              marker<%= @event.id %>.setAnimation(google.maps.Animation.BOUNCE);
            }
          }

       
      }

  </script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA_GEwouXTQg2YWEavFAE3R4uZpouYiK0U&callback=initMap" async defer></script>